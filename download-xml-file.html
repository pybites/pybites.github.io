<!DOCTYPE html>
<html lang="en">
    <head>

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Really? An article on downloading and saving an XML file? “Just use requests mate!”, I hear you all saying. Well, it’s not that simple. At least, it wasn’t as straight forward as that for a...">
        <meta name="keywords" content="beginners, learning, python, requests, tutorial, webscraping, xml">

        <meta property="og:site_name" content="PyBites"/>
        <meta property="og:title" content="How to Download an XML File with Python"/>
        <meta property="og:description" content="In this post I detail how to download an xml file to your OS and why it’s not as simple as you’d think"/>
        <meta property="og:locale" content="en_US"/>
        <meta property="og:url" content="https://pybit.es/download-xml-file.html"/>
        <meta property="og:type" content="article"/>
        <meta property="article:published_time" content="2017-05-04 20:46:00+02:00"/>
        <meta property="article:modified_time" content=""/>
        <meta property="article:author" content="https://pybit.es/author/julian.html">
        <meta property="article:section" content="Learning"/>
        <meta property="article:tag" content="tutorial"/>
        <meta property="article:tag" content="learning"/>
        <meta property="article:tag" content="webscraping"/>
        <meta property="article:tag" content="requests"/>
        <meta property="article:tag" content="xml"/>
        <meta property="article:tag" content="beginners"/>
        <meta property="article:tag" content="python"/>
        <meta property="og:image" content="https://pybit.es/images/featured/pb-article.png">

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@pybites" />
        <meta name="twitter:title" content="How to Download an XML File with Python" />
        <meta name="twitter:description" content="In this post I detail how to download an xml file to your OS and why it’s not as simple as you’d think" />
        <meta name="twitter:image" content="https://pybit.es/images/featured/pb-article.png">

        <link rel="icon" href="https://pybit.es/favicon.ico">
        <title>How to Download an XML File with Python - PyBites</title>

        <!-- Stylesheets -->
        <link href="https://pybit.es/theme/css/all.min.css" rel="stylesheet">
        <link href="https://pybit.es/theme/css/style.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="PyBites Full Atom Feed" />
        <link href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Full RSS Feed" />
        <link href="https://pybit.es/feeds/learning.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Categories RSS Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

          <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5859c6a67eb6254d" async="async"></script>

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-89294245-1', 'auto');
          ga('send', 'pageview');
        </script>
        <!-- /Google Analytics -->



    <!-- mailchimp subscribe -->
    <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">window.dojoRequire(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us14.list-manage.com","uuid":"822043293f280259d4b8d2a3e","lid":"ac7e2eb9ef","uniqueMethods":true}) })</script>
    <!-- end mailchimp subscribe -->

    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '767652523960315');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=767652523960315&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Facebook Pixel Code -->

    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="https://pybit.es/"><img class="mr20" src="https://pybit.es/images/logo.png" alt="logo"></a>
                    </div>
                    <div class="nav pull-right">

                        <div class="dropdown">
                          <span>RESOURCES</span>
                          <div class="dropdown-content">
                                <a href="https://www.pybitespodcast.com/"
                                    target="_blank"
                                >Podcast</a>
                                <a href="/community"
                                >Community</a>
                                <a href="/friends"
                                >Friends List</a>
                                <a href="/archives"
                                >Blog Articles</a>
                                <a href="/category/challenges"
                                >Blog Code Challenges</a>
                                <a href="https://github.com/PyBites-Open-Source"
                                    target="_blank"
                                >PyBites Open Source</a>
                                <a href="https://www.udemy.com/course/python-flask-for-beginners/"
                                    target="_blank"
                                >Flask Intro Course</a>
                                <a href="/100days"
                                >#100DaysOfCode</a>
                                <a href="https://codechalleng.es/tips"
                                    target="_blank"
                                >Weekly Email Tips</a>
                          </div>
                        </div>

                        <div class="dropdown">
                          <span>SERVICES</span>
                          <div class="dropdown-content">
                                <a href="https://codechalleng.es"
                                    target="_blank"
                                >Platform</a>
                                <a href="https://pybit.es/tips"
                                    target="_blank"
                                >Tips Book</a>
                                <a href="https://members.pybit.es/offers/mfFWRKHG/checkout"
                                    target="_blank"
                                >Python Intro Course</a>
                                <a href="https://pybitesproductivity.com/"
                                    target="_blank"
                                >Productivity Course</a>
                          </div>
                        </div>

                        <div class="dropdown">
                          <a href="https://pybitesdevelopermindset.com/" id="workshopButton" target="_blank">Python Coaching</a>
                        </div>

                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">How to Download an XML File with Python</h1>
                      <p class="header-date"> <a href="https://pybit.es/author/julian.html">Julian</a>, Thu 04 May 2017,  <a href="https://pybit.es/category/learning.html">Learning</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="https://pybit.es/tag/beginners.html">beginners</a>, <a href="https://pybit.es/tag/learning.html">learning</a>, <a href="https://pybit.es/tag/python.html">python</a>, <a href="https://pybit.es/tag/requests.html">requests</a>, <a href="https://pybit.es/tag/tutorial.html">tutorial</a>, <a href="https://pybit.es/tag/webscraping.html">webscraping</a>, <a href="https://pybit.es/tag/xml.html">xml</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>Really? An article on downloading and saving an XML file? “Just use requests mate!”, I hear you all saying. Well, it’s not that simple. At least, it wasn’t as straight forward as that for a beginner like me. Here’s why.</p>
<h2>Parsing is Different to Saving</h2>
<p>For sure, experts and beginners alike will have used requests to pull down the contents of a web page. Generally it’s for the purpose of parsing or scraping that page for specific data elements.</p>
<p>What if you wanted to actually <em>save</em> that web page to your local drive? Things get slightly different. You’re no longer just reading a text rendered version of the page, you’re trying to save the actual page in its original state.</p>
<p>This is what I found slightly confusing. I wasn’t dealing with a <code>text = r.text</code> situation anymore, I was trying to maintain the original format of the page as well, tabs and all.</p>
<h2>Why XML?</h2>
<p>I’m talking XML here because I was/am trying to download the actual XML file for an RSS feed I wanted to parse offline. For those of you playing at home, this is for our <a href="http://pybit.es/codechallenge17.html">PyBites Code Challenge 17</a> (hint hint!).</p>
<h2>Why Download when you can just Parse the feed itself?</h2>
<p>Good question! It’s about best practice and just being nice.</p>
<p>In the case of our code challenge (PCC17), how many times are you going to run your Py script while building the app to test if it works? Every time you run that script with your <code>requests.get</code> code in place, you’re making a call to the target web server.</p>
<p>This generates unnecessary traffic and load on that server which is a pretty crappy thing to do!</p>
<p>The nicer and Pythonic thing to do is to have a separate script that does the request once and saves the required data to a local file. Your primary scraping or analysis script then references the local file.</p>
<h2>Get to the code already!</h2>
<p>Alright, check it out:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;http://insert.your/feed/here.xml&quot;</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;feed.xml&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</pre></div>


<p>It all looks pretty familiar so I won’t go into detail on the usual suspects.</p>
<p>What I’m doing in this code is the following:</p>
<ul>
<li>Pulling the xml <em>content</em> down using <code>requests.get</code>.</li>
<li>Using a <code>with</code> statement to create a file called <code>feed.xml</code>. (If the file exists it’ll be overwritten).</li>
<li>Writing the <strong>contents</strong> of the requests response into the file <code>feed.xml</code>.</li>
</ul>
<p>Here’s why it was a learning exercise for me:</p>
<p>As I open/create the feed.xml file, I’m using the “Mode” <code>wb</code>. This means I’m opening the file for writing purposes but <strong>can only write to it in a binary format</strong>.</p>
<p>If you fail to choose the binary mode then you’ll get an error:</p>
<div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="k">call</span> <span class="k">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="ss">&quot;pull_xml.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">12</span><span class="p">,</span> <span class="k">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">file</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
<span class="n">TypeError</span><span class="p">:</span> <span class="k">write</span><span class="p">()</span> <span class="n">argument</span> <span class="n">must</span> <span class="n">be</span> <span class="n">str</span><span class="p">,</span> <span class="k">not</span> <span class="n">bytes</span>
</pre></div>


<p>This confused the hell out of me and resulted in me wasting time trying to convert the requests response data to different formats or writing to the external file one line at a time (which meant I lost formatting anyway!).</p>
<p>The binary mode is required to write the actual content of the XML page to your external file in the original format.</p>
<p>Speaking of content. Notice in the final <code>write</code> statement I’m using <code>response.content</code>? Have any idea how long I spent thinking my use of the usual <code>response.text</code> was the only way to do this? Too damn long!</p>
<p>Using the <code>content</code> option allows you to dump the entire XML file (as is) into your own local XML file. Brilliant!</p>
<blockquote>
<p>Note for beginners: If you’re reading other people’s code, be prepared to see <code>with</code> statements where files are opened <code>as f</code>. The same applies to the <code>requests</code> module. The line will generally read <code>r = requests.get(URL)</code>. I’ve used full form names for the sake of this article thus the words <em>file</em> and <em>response</em> in my code.</p>
</blockquote>
<h2>Conclusion</h2>
<p>This is one of those things that we all just get used to doing. Pulling a feed down and saving it to a file is something Bob has done a thousand times so no longer has to give it any extra thought.</p>
<p>For me, however, this took an entire night* of playing around because I’d never done it before and was assuming (silly me!) that the parsing code I've been using <code>requests</code> for was all I needed.</p>
<p>I also found that I had to scour a ton of StackOverflow posts and other documentation just to get my head wrapped around this concept correctly.</p>
<p>So with this finally cleared up, it’s time to go attack some feeds!</p>
<p>Keep Calm and Code in Python!</p>
<p>Julian</p>
<p>*Not really an entire night. I do need my beauty sleep!</p>


<div id="pbproducts">
  <h3>PyBites Python Tips</h3>
  <div>
    <p>Do you want to get <strong>250+ concise and applicable Python tips</strong> in an ebook that will cost you less than 10 bucks (future updates included), check it out <a href="https://gumroad.com/l/pbtips" target="_blank">here</a>.</p>
    <p>
      <a href="https://gumroad.com/l/pbtips" target="_blank">
        <img src="https://codechalleng.es/static/img/tips-book-thumb.07692e3ba331.png" alt="Get our Python Tips Book">
      </a>
    </p>

    <div id="testimonials">
      <p><i>"The discussions are succinct yet thorough enough to give you a solid grasp of the particular problem. I just wish I would have had this book when I started learning Python." - Daniel H </i></p>
      <p><i>"Bob and Julian are the masters at aggregating these small snippets of code that can really make certain aspects of coding easier." - Jesse B </i></p>
      <p><i>"This is now my favourite first Python go-to reference." - Anthony L </i></p>
      <p><i>"Do you ever go on one of those cooking websites for a recipe and have to scroll for what feels like an eternity to get to the ingredients and the 4 steps the recipe actually takes? This is the opposite of that." - Sergio S </i></p>
      <p class="buttonWrapper">
        <a class="button" href="https://gumroad.com/l/pbtips" target="_blank">
          Get the book
        </a>
      </p>
    </div>
  </div>
</div>    <div class="comments">
        <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'http-pybit-es';
                var disqus_identifier = 'download-xml-file.html';
                var disqus_url = 'https://pybit.es/download-xml-file.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
        <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>
        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="https://pybit.es/pages/guests.html">Authors</a></li>
                            <li><a href="https://pybit.es/pages/community.html">Community</a></li>
                            <li><a href="https://pybit.es/100days">#100DaysOfCode</a></li>
                            <li><a href="https://pybit.es/pages/search.html">Search</a></li>
                            <li><a href="https://pybit.es/pages/privacy-policy.html">Privacy Policy</a></li>
                              <li><a href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                              <li><a href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS Feed</a></li>
                            <li><a href="mailto:support@pybit.es" title="Contact us by email">Contact Us</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Reach Out</div>
                        <ul class="list-unstyled">
                            <li><a href="mailto:support@pybit.es" target="_blank">Email</a></li>
                            <li><a href="https://twitter.com/pybites" target="_blank">Twitter</a></li>
                            <li><a href="https://facebook.com/pybites" target="_blank">Facebook</a></li>
                            <li><a href="https://github.com/pybites" target="_blank">Github</a></li>
                            <li><a href="https://github.com/PyBites-Open-Source" target="_blank">Open Source</a></li>
                            <li><a href="https://www.youtube.com/channel/UCBn-uKDGsRBfcB0lQeOB_gA" target="_blank">YouTube</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; PyBites 2016+</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>