<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="It&#39;s Friday again so we review the code challenge of this week. It&#39;s never late to join, just fork our challenges repo and start coding. A possible solution See here and commented below. Some...">
        <meta name="keywords" content="blog, code review, codechallenges, github, learning, similarity, tags">
        <link rel="icon" href="https://pybit.es/favicon.ico">

        <title>Code Challenge 03 - PyBites Blog Tag Analysis - Review - PyBites</title>

        <!-- Stylesheets -->
        <link href="https://pybit.es/theme/css/all.min.css" rel="stylesheet">
        <link href="https://pybit.es/theme/css/style.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="PyBites Full Atom Feed" />
        <link href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Full RSS Feed" />
        <link href="https://pybit.es/feeds/challenges.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Categories RSS Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

          <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5859c6a67eb6254d" async="async"></script>

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-89294245-1', 'auto');
          ga('send', 'pageview');
        </script>
        <!-- /Google Analytics -->



    <!-- mailchimp subscribe -->
    <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">window.dojoRequire(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us14.list-manage.com","uuid":"822043293f280259d4b8d2a3e","lid":"ac7e2eb9ef","uniqueMethods":true}) })</script>
    <!-- end mailchimp subscribe -->

    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '204929054292880');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=204929054292880&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Facebook Pixel Code -->

    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="https://pybit.es/"><img class="mr20" src="https://pybit.es/images/logo.png" alt="logo"></a>
                    </div>
                    <div class="nav pull-right">

                        <div class="dropdown">
                          <span>RESOURCES</span>
                          <div class="dropdown-content">
                                <a href="/archives"
                                >Articles</a>
                                <a href="/pages/friends"
                                >Friends List</a>
                                <a href="/pages/community"
                                >Community</a>
                                <a href="/category/challenges"
                                >Blog Challenges</a>
                                <a href="https://github.com/PyBites-Open-Source"
                                    target="_blank"
                                >Open Source</a>
                                <a href="https://www.udemy.com/course/python-flask-for-beginners/"
                                    target="_blank"
                                >Flask Intro Course</a>
                          </div>
                        </div>

                        <div class="dropdown">
                          <span>SERVICES</span>
                          <div class="dropdown-content">
                                <a href="/pages/newbie"
                                >Newbies</a>
                                <a href="https://codechalleng.es"
                                    target="_blank"
                                >Python Exercises</a>
                                <a href="/pages/schools"
                                >Schools</a>
                                <a href="/pages/enterprise"
                                >Enterprise</a>
                                <a href="/pages/recruiting"
                                >Recruiter</a>
                                <a href="/pages/100days"
                                >100 Days Of Code</a>
                                <a href="/pages/apply"
                                >Coaching</a>
                          </div>
                        </div>

                        <div class="dropdown">
                          <a href="https://pybit.es/pages/talk" id="workshopButton">Talk With Us</a>
                        </div>

                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Code Challenge 03 - PyBites Blog Tag Analysis - Review</h1>
                      <p class="header-date"> <a href="https://pybit.es/author/pybites.html">PyBites</a>, Fri 27 January 2017,  <a href="https://pybit.es/category/challenges.html">Challenges</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="https://pybit.es/tag/blog.html">blog</a>, <a href="https://pybit.es/tag/code-review.html">code review</a>, <a href="https://pybit.es/tag/codechallenges.html">codechallenges</a>, <a href="https://pybit.es/tag/github.html">github</a>, <a href="https://pybit.es/tag/learning.html">learning</a>, <a href="https://pybit.es/tag/similarity.html">similarity</a>, <a href="https://pybit.es/tag/tags.html">tags</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>It's Friday again so we review the <a href="http://pybit.es/codechallenge03.html">code challenge of this week</a>. It's never late to join, just fork our <a href="https://github.com/pybites/challenges">challenges repo</a> and start coding.</p>
<h2>A possible solution</h2>
<p>See <a href="https://github.com/pybites/challenges/blob/solutions/03/tags.py">here</a> and commented below.</p>
<p>Some learnings:</p>
<ul>
<li>
<p>We use the stdlib to its fullest:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">difflib</span> <span class="kn">import</span> <span class="n">SequenceMatcher</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">import</span> <span class="nn">re</span>
</pre></div>


</li>
<li>
<p>We define constants at the top. We use maketrans to easily extend replacing multiple characters in the future:</p>
<div class="highlight"><pre><span></span><span class="n">REPLACE_CHARS</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">IDENTICAL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
<span class="n">TOP_NUMBER</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">RSS_FEED</span> <span class="o">=</span> <span class="s1">&#39;rss.xml&#39;</span>
<span class="k">SIMILAR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">87</span>
</pre></div>


</li>
<li>
<p>We used a regular expression to show that you can. A better way would be to use a PyPI package like feedparser or BeautifulSoup (see further down). </p>
<div class="highlight"><pre><span></span><span class="nv">TAG_HTML</span> <span class="o">=</span> <span class="nv">re</span>.<span class="nv">compile</span><span class="ss">(</span><span class="nv">r</span><span class="s1">&#39;</span><span class="s">&lt;category&gt;([^&lt;]+)&lt;/category&gt;</span><span class="s1">&#39;</span><span class="ss">)</span>

<span class="nv">def</span> <span class="nv">get_tags</span><span class="ss">()</span>:
    <span class="s2">&quot;&quot;&quot;</span><span class="s">Find all tags (TAG_HTML) in RSS_FEED.</span>
    <span class="nv">Replace</span> <span class="nv">dash</span> <span class="nv">with</span> <span class="nv">whitespace</span> <span class="ss">(</span><span class="nv">REPLACE_CHARS</span><span class="ss">)</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="nv">with</span> <span class="nv">open</span><span class="ss">(</span><span class="nv">RSS_FEED</span><span class="ss">)</span> <span class="nv">as</span> <span class="nv">f</span>:
        <span class="nv">tags</span> <span class="o">=</span> <span class="nv">TAG_HTML</span>.<span class="nv">findall</span><span class="ss">(</span><span class="nv">f</span>.<span class="nv">read</span><span class="ss">()</span>.<span class="nv">lower</span><span class="ss">())</span>
    <span class="k">return</span> [<span class="nv">tag</span>.<span class="nv">translate</span><span class="ss">(</span><span class="nv">REPLACE_CHARS</span><span class="ss">)</span> <span class="k">for</span> <span class="nv">tag</span> <span class="nv">in</span> <span class="nv">tags</span>]
</pre></div>


</li>
<li>
<p>For everything counting related you really want to use collections.Counter and its most_common method</p>
<div class="highlight"><pre><span></span><span class="nv">def</span> <span class="nv">get_top_tags</span><span class="ss">(</span><span class="nv">tags</span><span class="ss">)</span>:
    <span class="s2">&quot;&quot;&quot;</span><span class="s">Get the TOP_NUMBER of most common tags</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nv">Counter</span><span class="ss">(</span><span class="nv">tags</span><span class="ss">)</span>.<span class="nv">most_common</span><span class="ss">(</span><span class="nv">TOP_NUMBER</span><span class="ss">)</span>
</pre></div>


</li>
<li>
<p>For similarities we were going to read up on <a href="http://www.nltk.org/">NLTK</a> but stdlib has difflib.SequenceMatcher which makes this very easy (found <a href="http://stackoverflow.com/questions/17388213/find-the-similarity-percent-between-two-strings">on Stackoverflow</a>). We gained quite some performance first matching the first char between tags, but this assumes the first char is always the same. If you don't want that, take that check out. We use itertools.product instead of a double for loop. Lastly yield makes get_similarities a generator which we find more Pythonic.</p>
<div class="highlight"><pre><span></span><span class="nv">def</span> <span class="nv">get_similarities</span><span class="ss">(</span><span class="nv">tags</span><span class="ss">)</span>:
    <span class="s2">&quot;&quot;&quot;</span><span class="s">Find set of tags pairs with similarity ratio of &gt; SIMILAR</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="nv">pair</span> <span class="nv">in</span> <span class="nv">product</span><span class="ss">(</span><span class="nv">tags</span>, <span class="nv">tags</span><span class="ss">)</span>:
        # <span class="nv">performance</span> <span class="nv">enhancements</span> <span class="mi">1</span>.<span class="mi">992</span><span class="nv">s</span> <span class="o">-&gt;</span> <span class="mi">0</span>.<span class="mi">144</span><span class="nv">s</span>
        <span class="k">if</span> <span class="nv">pair</span>[<span class="mi">0</span>][<span class="mi">0</span>] <span class="o">!=</span> <span class="nv">pair</span>[<span class="mi">1</span>][<span class="mi">0</span>]:
            <span class="k">continue</span>
        <span class="nv">pair</span> <span class="o">=</span> <span class="nv">tuple</span><span class="ss">(</span><span class="nv">sorted</span><span class="ss">(</span><span class="nv">pair</span><span class="ss">))</span>  # <span class="nv">set</span> <span class="nv">needs</span> <span class="nv">hashable</span> <span class="nv">type</span>
        <span class="nv">similarity</span> <span class="o">=</span> <span class="nv">SequenceMatcher</span><span class="ss">(</span><span class="nv">None</span>, <span class="o">*</span><span class="nv">pair</span><span class="ss">)</span>.<span class="nv">ratio</span><span class="ss">()</span>
        <span class="k">if</span> <span class="nv">SIMILAR</span> <span class="o">&lt;</span> <span class="nv">similarity</span> <span class="o">&lt;</span> <span class="nv">IDENTICAL</span>:
            <span class="nv">yield</span> <span class="nv">pair</span>
</pre></div>


</li>
<li>
<p>The calling code was given, printing it here for completeness:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="nv">__name__</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="s">__main__</span><span class="s2">&quot;</span>:
    <span class="nv">tags</span> <span class="o">=</span> <span class="nv">get_tags</span><span class="ss">()</span>
    <span class="nv">top_tags</span> <span class="o">=</span> <span class="nv">get_top_tags</span><span class="ss">(</span><span class="nv">tags</span><span class="ss">)</span>
    <span class="nv">print</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">* Top {} tags:</span><span class="s1">&#39;</span>.<span class="nv">format</span><span class="ss">(</span><span class="nv">TOP_NUMBER</span><span class="ss">))</span>
    <span class="k">for</span> <span class="nv">tag</span>, <span class="nv">count</span> <span class="nv">in</span> <span class="nv">top_tags</span>:
        <span class="nv">print</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">{:&lt;20} {}</span><span class="s1">&#39;</span>.<span class="nv">format</span><span class="ss">(</span><span class="nv">tag</span>, <span class="nv">count</span><span class="ss">))</span>
    <span class="nv">similar_tags</span> <span class="o">=</span> <span class="nv">dict</span><span class="ss">(</span><span class="nv">get_similarities</span><span class="ss">(</span><span class="nv">tags</span><span class="ss">))</span>
    <span class="nv">print</span><span class="ss">()</span>
    <span class="nv">print</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">* Similar tags:</span><span class="s1">&#39;</span><span class="ss">)</span>
    <span class="k">for</span> <span class="nv">singular</span>, <span class="nv">plural</span> <span class="nv">in</span> <span class="nv">similar_tags</span>.<span class="nv">items</span><span class="ss">()</span>:
        <span class="nv">print</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">{:&lt;20} {}</span><span class="s1">&#39;</span>.<span class="nv">format</span><span class="ss">(</span><span class="nv">singular</span>, <span class="nv">plural</span><span class="ss">))</span>
</pre></div>


</li>
<li>
<p>Tests pass:</p>
<div class="highlight"><pre><span></span>$ git checkout solutions
$ python test_tags.py 
...
----------------------------------------------------------------------
Ran <span class="m">3</span> tests in <span class="m">0</span>.153s

OK
</pre></div>


</li>
</ul>
<hr>
<h2>Code challenges != Python's 'preferably only one way'</h2>
<p>We know '&gt;&gt;&gt; import this' says: "There should be one-- and preferably only one --obvious way to do it." and usually there is. Yet for our challenges we encourage people to be creative and not stick to the template + tests per se (we improve the code challenge format as we learn ...). </p>
<p>For example Jeffrey parses our feed directly in <a href="https://gist.github.com/jrjames83/eeda4324116dde12ea8d45c47a151ab0">his solution</a> with requests and BeautifulSoup not stripping off the dash. This is great addition to our solution, using PyPI whenever you can is recommended. Also by parsing the live feed he created us a tool to run this check every now and then (thanks Jeffrey). We like to see different solutions.</p>
<h2>Any issues or feedback?</h2>
<p>What did you learn this challenge? Feel free to share you code in the comments below. </p>
<p>How are you experiencing these challenges? You like the format? What can we do differently and/or better?</p>
<h2>next(challenges)</h2>
<p>Monday we will be back with a fresh new challenge, stay tuned ...</p>
<p>Again to start coding <a href="https://github.com/pybites/challenges">fork our challenges repo</a> or <a href="https://help.github.com/articles/syncing-a-fork/">sync it</a> if you already forked it.</p>


    <div class="comments">
        <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'http-pybit-es';
                var disqus_identifier = 'codechallenge03_review.html';
                var disqus_url = 'https://pybit.es/codechallenge03_review.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
        <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>
        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="https://pybit.es/pages/guests.html">Authors</a></li>
                            <li><a href="https://pybit.es/pages/community.html">Community</a></li>
                            <li><a href="https://pybit.es/pages/100days.html">100 Days Of Code</a></li>
                            <li><a href="https://pybit.es/pages/search.html">Search</a></li>
                            <li><a href="https://pybit.es/pages/privacy-policy.html">Privacy Policy</a></li>
                              <li><a href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                              <li><a href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS Feed</a></li>
                            <li><a href="mailto:support@pybit.es" title="Contact us by email">Contact Us</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Reach Out</div>
                        <ul class="list-unstyled">
                            <li><a href="mailto:support@pybit.es" target="_blank">Email</a></li>
                            <li><a href="https://twitter.com/pybites" target="_blank">Twitter</a></li>
                            <li><a href="https://facebook.com/pybites" target="_blank">Facebook</a></li>
                            <li><a href="https://github.com/pybites" target="_blank">Github</a></li>
                            <li><a href="https://github.com/PyBites-Open-Source" target="_blank">Open Source</a></li>
                            <li><a href="https://www.youtube.com/channel/UCBn-uKDGsRBfcB0lQeOB_gA" target="_blank">YouTube</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; PyBites 2016+</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>