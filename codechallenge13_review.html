<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="It&#39;s end of the week again so we review the code challenge of this week: Highest Rated Movie Directors. It&#39;s never late to join, just fork us and start coding. Our solution and learning You can...">
        <meta name="keywords" content="codechallenges, data analysis, defaultdict, imdb, learning, movies, namedtuples, sort">
        <link rel="icon" href="https://pybit.es/favicon.ico">

        <title>Code Challenge 13 - Highest Rated Movie Directors - Review - PyBites</title>

        <!-- Stylesheets -->
        <link href="https://pybit.es/theme/css/all.min.css" rel="stylesheet">
        <link href="https://pybit.es/theme/css/style.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="PyBites Full Atom Feed" />
        <link href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Full RSS Feed" />
        <link href="https://pybit.es/feeds/challenges.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Categories RSS Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

          <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5859c6a67eb6254d" async="async"></script>

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-89294245-1', 'auto');
          ga('send', 'pageview');
        </script>
        <!-- /Google Analytics -->



    <!-- mailchimp subscribe -->
    <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">window.dojoRequire(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us14.list-manage.com","uuid":"822043293f280259d4b8d2a3e","lid":"ac7e2eb9ef","uniqueMethods":true}) })</script>
    <!-- end mailchimp subscribe -->

    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '204929054292880');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=204929054292880&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Facebook Pixel Code -->

    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="https://pybit.es/"><img class="mr20" src="https://pybit.es/images/logo.png" alt="logo"></a>
                    </div>
                    <div class="nav pull-right">

                        <div class="dropdown">
                          <span>RESOURCES</span>
                          <div class="dropdown-content">
                                <a href="/archives"
                                >Articles</a>
                                <a href="/pages/friends"
                                >Friends List</a>
                                <a href="/pages/community"
                                >Community</a>
                                <a href="/category/challenges"
                                >Blog Challenges</a>
                                <a href="https://github.com/PyBites-Open-Source"
                                    target="_blank"
                                >Open Source</a>
                                <a href="https://www.udemy.com/course/python-flask-for-beginners/"
                                    target="_blank"
                                >Flask Intro Course</a>
                          </div>
                        </div>

                        <div class="dropdown">
                          <span>SERVICES</span>
                          <div class="dropdown-content">
                                <a href="/pages/newbie"
                                >Newbies</a>
                                <a href="https://codechalleng.es"
                                    target="_blank"
                                >Python Exercises</a>
                                <a href="/pages/schools"
                                >Schools</a>
                                <a href="/pages/enterprise"
                                >Enterprise</a>
                                <a href="/pages/recruiting"
                                >Recruiter</a>
                                <a href="/pages/100days"
                                >100 Days Of Code</a>
                                <a href="/pages/apply"
                                >Coaching</a>
                          </div>
                        </div>

                        <div class="dropdown">
                          <a href="https://pybit.es/pages/promotion" id="workshopButton">Dev Workshop</a>
                        </div>

                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Code Challenge 13 - Highest Rated Movie Directors - Review</h1>
                      <p class="header-date"> <a href="https://pybit.es/author/pybites.html">PyBites</a>, Sat 08 April 2017,  <a href="https://pybit.es/category/challenges.html">Challenges</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="https://pybit.es/tag/codechallenges.html">codechallenges</a>, <a href="https://pybit.es/tag/data-analysis.html">data analysis</a>, <a href="https://pybit.es/tag/defaultdict.html">defaultdict</a>, <a href="https://pybit.es/tag/imdb.html">imdb</a>, <a href="https://pybit.es/tag/learning.html">learning</a>, <a href="https://pybit.es/tag/movies.html">movies</a>, <a href="https://pybit.es/tag/namedtuples.html">namedtuples</a>, <a href="https://pybit.es/tag/sort.html">sort</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>It's end of the week again so we review the code challenge of this week: <a href="http://pybit.es/codechallenge13.html">Highest Rated Movie Directors</a>. It's never late to join, just <a href="https://github.com/pybites/challenges">fork us</a> and start coding.</p>
<h2>Our solution and learning</h2>
<p>You can find our solution <a href="https://github.com/pybites/challenges/blob/solutions/13/directors.py">here</a>. Some highlights:</p>
<ul>
<li>
<p>In get_movies_by_director() we use csv.DictReader to parse the csv file:</p>
<div class="highlight"><pre><span></span><span class="nv">with</span> <span class="nv">open</span><span class="ss">(</span><span class="nv">MOVIE_DATA</span><span class="ss">)</span> <span class="nv">as</span> <span class="nv">f</span>:
    <span class="k">for</span> <span class="nv">line</span> <span class="nv">in</span> <span class="nv">csv</span>.<span class="nv">DictReader</span><span class="ss">(</span><span class="nv">f</span><span class="ss">)</span>:
        ...
</pre></div>


</li>
<li>
<p>We use a defaultdict(list) for our initial parsing of movies:</p>
<div class="highlight"><pre><span></span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Movie</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">movie</span><span class="p">,</span><span class="w"> </span><span class="nf">year</span><span class="o">=</span><span class="nf">year</span><span class="p">,</span><span class="w"> </span><span class="n">score</span><span class="o">=</span><span class="n">score</span><span class="p">)</span><span class="w"></span>
<span class="n">directors</span><span class="o">[</span><span class="n">director</span><span class="o">]</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"></span>
</pre></div>


</li>
<li>
<p>get_average_scores() returns a directors dict via a dict comprehension (note the <a href="https://github.com/pybites/challenges/commit/959acf258a99730b732eb0915aa2088adf11e143">subtle refactoring</a>, glad we had our tests), where keys are (director, mean score) and values their movies. We only take directors with at least MIN_MOVIES.</p>
</li>
<li>
<p>Although Python3 has statistics.mean we rolled our own (_calc_mean) because we first extract the score from the Movie namedtupe and added rounding (although that should maybe go in the print_results function). </p>
<p>Next time we would use statistics.mean, because the more you leverage the stdlib the better. These considerations happen when coding, reviewing your and others code, good learning. </p>
<p>Although movies should not be 0 we are defensive by never allowing the denominator to be 0:</p>
<div class="highlight"><pre><span></span><span class="n">mean</span> <span class="o">=</span> <span class="k">sum</span><span class="p">(</span><span class="n">ratings</span><span class="p">)</span> <span class="o">/</span> <span class="k">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">len</span><span class="p">(</span><span class="n">ratings</span><span class="p">))</span>
</pre></div>


<p>You could also write: </p>
<div class="highlight"><pre><span></span><span class="nv">mean</span> <span class="o">=</span> <span class="nv">sum</span><span class="ss">(</span><span class="nv">ratings</span><span class="ss">)</span> <span class="o">/</span> <span class="nv">len</span><span class="ss">(</span><span class="nv">ratings</span><span class="ss">)</span> <span class="k">if</span> <span class="nv">ratings</span> <span class="k">else</span> <span class="mi">0</span>
</pre></div>


</li>
<li>
<p>print_results() then prints the desired output. The enumerate is handy to get the sequence numbers for the top NUM_TOP_DIRECTORS directors. You can give it a start with a 2nd argument, 1 in this case. </p>
<p>We used zfill before to print 01 / 02 etc., but found out that <a href="https://github.com/pybites/challenges/commit/72b4642e24058758530ea463cbd3c0fbe2dfce1d">you can tackle this in the format syntax</a>. We might refactor all these formats to use F-string, it would make this a lot cleaner :)</p>
</li>
<li>
<p>Again it was nice to work on this code having tests:</p>
<div class="highlight"><pre><span></span>$ python test_directors.py
tests pass
</pre></div>


</li>
</ul>
<h2>TODOs</h2>
<p>We realized during the challenge that you could also solve this with SQL or Pandas. We will update the solutions branch when we get around this. It would be nice to give it a try. Of course if you took these (or other) approaches feel free to share your solution <a href="https://github.com/pybites/challenges/compare">opening a PR against our community branch</a>.</p>
<h2>Community</h2>
<p>Here is <a href="https://github.com/pybites/challenges/blob/community/13/directors-atakume.py">another solution by atakume</a> we merged in our community branch. What we like about this solution is the use of itertools.groupby, doing the sorting outside the print_results function, and the second namedtuple which adds readability:</p>
<div class="highlight"><pre><span></span><span class="n">Filmography</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Filmography&#39;</span><span class="p">,</span> <span class="s1">&#39;director movies avg_score&#39;</span><span class="p">)</span>
</pre></div>


<h2>Stay tuned</h2>
<p>Next week we will let you play with decorators, a great feature for writing DRY, reusable code. It will be fun :)</p>
<p>We hope you are enjoying these challenges, learning along the way. Let us know <a href="https://github.com/pybites/challenges/issues/new">if you have any issue</a> and/or <a href="mailto:pybitesblog@gmail.com">contact us</a> if you want to submit a cool challenge. See you next week ...</p>


    <div class="comments">
        <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'http-pybit-es';
                var disqus_identifier = 'codechallenge13_review.html';
                var disqus_url = 'https://pybit.es/codechallenge13_review.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
        <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>
        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="https://pybit.es/pages/guests.html">Authors</a></li>
                            <li><a href="https://pybit.es/pages/community.html">Community</a></li>
                            <li><a href="https://pybit.es/pages/100days.html">100 Days Of Code</a></li>
                            <li><a href="https://pybit.es/pages/search.html">Search</a></li>
                            <li><a href="https://pybit.es/pages/privacy-policy.html">Privacy Policy</a></li>
                              <li><a href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                              <li><a href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS Feed</a></li>
                            <li><a href="mailto:support@pybit.es" title="Contact us by email">Contact Us</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Reach Out</div>
                        <ul class="list-unstyled">
                            <li><a href="mailto:support@pybit.es" target="_blank">Email</a></li>
                            <li><a href="https://twitter.com/pybites" target="_blank">Twitter</a></li>
                            <li><a href="https://facebook.com/pybites" target="_blank">Facebook</a></li>
                            <li><a href="https://github.com/pybites" target="_blank">Github</a></li>
                            <li><a href="https://github.com/PyBites-Open-Source" target="_blank">Open Source</a></li>
                            <li><a href="https://www.youtube.com/channel/UCBn-uKDGsRBfcB0lQeOB_gA" target="_blank">YouTube</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; PyBites 2016+</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>