<!DOCTYPE html>
<html lang="en">
    <head>

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Have you ever wondered how to get Python source code quickly? It turns out the Standard Library can do this pretty effortlessly. Here is some code to read more Python source. The code The source /...">
        <meta name="keywords" content="argparse, bash, importlib, inspect, pathlib, pydoc, source code, Standard Library, vim">

        <meta property="og:site_name" content="PyBites"/>
        <meta property="og:title" content="Get to Python source code instantly using importlib and inspect"/>
        <meta property="og:description" content="Have you ever wondered how to get Python source code quickly? It turns out the Standard Library can do this pretty effortlessly. Here is some code to read more Python source."/>
        <meta property="og:locale" content="en_US"/>
        <meta property="og:url" content="https://pybit.es/get-python-source.html"/>
        <meta property="og:type" content="article"/>
        <meta property="article:published_time" content="2020-12-14 19:05:00+01:00"/>
        <meta property="article:modified_time" content=""/>
        <meta property="article:author" content="https://pybit.es/author/bob.html">
        <meta property="article:section" content="Tools"/>
        <meta property="article:tag" content="importlib"/>
        <meta property="article:tag" content="inspect"/>
        <meta property="article:tag" content="vim"/>
        <meta property="article:tag" content="bash"/>
        <meta property="article:tag" content="source code"/>
        <meta property="article:tag" content="pathlib"/>
        <meta property="article:tag" content="Standard Library"/>
        <meta property="article:tag" content="argparse"/>
        <meta property="article:tag" content="pydoc"/>
        <meta property="og:image" content="https://pybit.es/images/featured/pb-article.png">

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@pybites" />
        <meta name="twitter:title" content="Get to Python source code instantly using importlib and inspect" />
        <meta name="twitter:description" content="Have you ever wondered how to get Python source code quickly? It turns out the Standard Library can do this pretty effortlessly. Here is some code to read more Python source." />
        <meta name="twitter:image" content="https://pybit.es/images/featured/pb-article.png">

        <link rel="icon" href="https://pybit.es/favicon.ico">
        <title>Get to Python source code instantly using importlib and inspect - PyBites</title>

        <!-- Stylesheets -->
        <link href="https://pybit.es/theme/css/all.min.css" rel="stylesheet">
        <link href="https://pybit.es/theme/css/style.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="PyBites Full Atom Feed" />
        <link href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Full RSS Feed" />
        <link href="https://pybit.es/feeds/tools.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Categories RSS Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

          <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5859c6a67eb6254d" async="async"></script>

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-89294245-1', 'auto');
          ga('send', 'pageview');
        </script>
        <!-- /Google Analytics -->



    <!-- mailchimp subscribe -->
    <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">window.dojoRequire(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us14.list-manage.com","uuid":"822043293f280259d4b8d2a3e","lid":"ac7e2eb9ef","uniqueMethods":true}) })</script>
    <!-- end mailchimp subscribe -->

    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '767652523960315');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=767652523960315&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Facebook Pixel Code -->

    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="https://pybit.es/"><img class="mr20" src="https://pybit.es/images/logo.png" alt="logo"></a>
                    </div>
                    <div class="nav pull-right">

                        <div class="dropdown">
                          <span>RESOURCES</span>
                          <div class="dropdown-content">
                                <a href="https://www.pybitespodcast.com/"
                                    target="_blank"
                                >Podcast</a>
                                <a href="/community"
                                >Community</a>
                                <a href="/friends"
                                >Friends List</a>
                                <a href="/archives"
                                >Blog Articles</a>
                                <a href="/category/challenges"
                                >Blog Code Challenges</a>
                                <a href="https://github.com/PyBites-Open-Source"
                                    target="_blank"
                                >PyBites Open Source</a>
                                <a href="https://www.udemy.com/course/python-flask-for-beginners/"
                                    target="_blank"
                                >Flask Intro Course</a>
                                <a href="/100days"
                                >#100DaysOfCode</a>
                          </div>
                        </div>

                        <div class="dropdown">
                          <span>SERVICES</span>
                          <div class="dropdown-content">
                                <a href="https://codechalleng.es"
                                    target="_blank"
                                >Platform</a>
                                <a href="https://pybit.es/tips"
                                    target="_blank"
                                >Tips Book</a>
                                <a href="https://members.pybit.es/offers/mfFWRKHG/checkout"
                                    target="_blank"
                                >Python Intro Course</a>
                                <a href="https://members.pybit.es/offers/3YM2CTby/checkout"
                                    target="_blank"
                                >Productivity Course</a>
                          </div>
                        </div>

                        <div class="dropdown">
                          <a href="https://pybitesdevelopermindset.com/" id="workshopButton" target="_blank">Python Coaching</a>
                        </div>

                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Get to Python source code instantly using importlib and inspect</h1>
                      <p class="header-date"> <a href="https://pybit.es/author/bob.html">Bob</a>, Mon 14 December 2020,  <a href="https://pybit.es/category/tools.html">Tools</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="https://pybit.es/tag/argparse.html">argparse</a>, <a href="https://pybit.es/tag/bash.html">bash</a>, <a href="https://pybit.es/tag/importlib.html">importlib</a>, <a href="https://pybit.es/tag/inspect.html">inspect</a>, <a href="https://pybit.es/tag/pathlib.html">pathlib</a>, <a href="https://pybit.es/tag/pydoc.html">pydoc</a>, <a href="https://pybit.es/tag/source-code.html">source code</a>, <a href="https://pybit.es/tag/standard-library.html">Standard Library</a>, <a href="https://pybit.es/tag/vim.html">vim</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>Have you ever wondered how to get Python source code quickly? It turns out the Standard Library can do this pretty effortlessly. Here is some code to read more Python source.</p>
<h2>The code</h2>
<p>The source / project is <a href="https://github.com/PyBites-Open-Source/pysource">here</a>:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">pydoc</span>
</pre></div>


<p>Here is where the magic happens (credit to <a href="https://stackoverflow.com/a/8790232">this Stack Overflow</a> thread): we use <code>importlib</code> to import the module from a string and get the class or function from this imported module using <code>getattr</code>:</p>
<div class="highlight"><pre><span></span># <span class="nv">src</span><span class="o">/</span><span class="nv">pysource</span>.<span class="nv">py</span>
<span class="nv">def</span> <span class="nv">get_callable</span><span class="ss">(</span><span class="nv">arg</span><span class="ss">)</span>:
    <span class="nv">module_str</span>, <span class="nv">name</span> <span class="o">=</span> <span class="nv">arg</span>.<span class="nv">rsplit</span><span class="ss">(</span><span class="s2">&quot;</span><span class="s">.</span><span class="s2">&quot;</span>, <span class="mi">1</span><span class="ss">)</span>
    <span class="nv">module</span> <span class="o">=</span> <span class="nv">importlib</span>.<span class="nv">import_module</span><span class="ss">(</span><span class="nv">module_str</span><span class="ss">)</span>
    <span class="k">return</span> <span class="nv">getattr</span><span class="ss">(</span><span class="nv">module</span>, <span class="nv">name</span><span class="ss">)</span>
</pre></div>


<p>Then we print it out. By default we use <code>print</code>, but if <code>pager</code> is <code>True</code> we use <code>pydoc.pager</code> which works like Unix <code>more</code>: it waits for you to press spacebar and you can use <code>/</code> for searching / string matching, pretty cool!</p>
<div class="highlight"><pre><span></span># <span class="nv">src</span><span class="o">/</span><span class="nv">pysource</span>.<span class="nv">py</span>
<span class="nv">def</span> <span class="nv">print_source</span><span class="ss">(</span><span class="nv">func</span>, <span class="nv">pager</span><span class="o">=</span><span class="nv">False</span><span class="ss">)</span>:
    <span class="nv">output</span> <span class="o">=</span> <span class="nv">pydoc</span>.<span class="nv">pager</span> <span class="k">if</span> <span class="nv">pager</span> <span class="k">else</span> <span class="nv">print</span>
    <span class="nv">output</span><span class="ss">(</span><span class="nv">inspect</span>.<span class="nv">getsource</span><span class="ss">(</span><span class="nv">func</span><span class="ss">))</span>
</pre></div>


<hr>
<p>To make it stick, check out <a href="https://codechalleng.es/tips/import-module-from-a-string">another example of <code>importlib.import_module</code></a> and <a href="https://codechalleng.es/tips/read-in-source-code">here is another example of <code>inspect</code></a>.</p>
<hr>
<p>Lastly in <code>src/__main__.py</code> we handle command line arguments. We require a <code>module(.submodule).name</code> for which we want to see the source and we have an optional <code>pager</code> argument. Then we call the two functions:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">src</span><span class="o">/</span><span class="n">__main__</span><span class="p">.</span><span class="n">py</span>
<span class="n">def</span> <span class="n">main</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Read Python source.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="ss">&quot;-m&quot;</span><span class="p">,</span> <span class="ss">&quot;--module&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;module&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;module(.submodule).name&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="ss">&quot;-p&quot;</span><span class="p">,</span> <span class="ss">&quot;--pager&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;use_pager&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;page output (like Unix more command)&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">func</span> <span class="o">=</span> <span class="n">get_callable</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">module</span><span class="p">)</span>
    <span class="n">print_source</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">pager</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">use_pager</span><span class="p">)</span>
</pre></div>


<p>(I used <code>sys.argv</code> in my first iteration, but <code>argparse</code> makes this so much more cleaner and extensible! Of course <a href="https://pybit.es/guest-exploring-python-clis.html">there are more options</a> as well ...)</p>
<h2>Calling it from within Vim</h2>
<p>I stored this script in my <code>$HOME/bin</code> folder and <a href="https://michaelabrahamsen.com/">Michael</a> was so kind to come up with an alias to use it in Vim:</p>
<div class="highlight"><pre><span></span><span class="nv">autocmd</span> <span class="nv">FileType</span> <span class="nv">python</span> <span class="nv">map</span> <span class="o">&lt;</span><span class="nv">leader</span><span class="o">&gt;</span><span class="nv">py</span> :<span class="k">exec</span> <span class="s1">&#39;</span><span class="s">!python3.9 $HOME/bin/pysource.py -m &lt;C-R&gt;&lt;C-A&gt; -p</span><span class="s1">&#39;</span><span class="o">&lt;</span><span class="nv">CR</span><span class="o">&gt;</span>
</pre></div>


<p>He even made this nice little gif demo how it calls the script when you press <code>&lt;leader&gt;py</code> when you are on <code>module.class</code> or <code>module.function</code>:</p>
<p><img alt="demo of this script" src="https://pybit.es/images/pysource-example.gif"></p>
<p>Here we actually wanted to know how <code>pathlib</code> did operator overloading (answer: it implements <code>__truediv__</code>).</p>
<p>Of course you can also just call it from the command line:</p>
<div class="highlight"><pre><span></span>$ <span class="nv">pysource</span> <span class="o">-</span><span class="nv">m</span> <span class="nv">re</span>.<span class="nv">match</span>
<span class="nv">def</span> <span class="nv">match</span><span class="ss">(</span><span class="nv">pattern</span>, <span class="nv">string</span>, <span class="nv">flags</span><span class="o">=</span><span class="mi">0</span><span class="ss">)</span>:
    <span class="s2">&quot;&quot;&quot;</span><span class="s">Try to apply the pattern at the start of the string, returning</span>
    <span class="nv">a</span> <span class="nv">Match</span> <span class="nv">object</span>, <span class="nv">or</span> <span class="nv">None</span> <span class="k">if</span> <span class="nv">no</span> <span class="nv">match</span> <span class="nv">was</span> <span class="nv">found</span>.<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nv">_compile</span><span class="ss">(</span><span class="nv">pattern</span>, <span class="nv">flags</span><span class="ss">)</span>.<span class="nv">match</span><span class="ss">(</span><span class="nv">string</span><span class="ss">)</span>
</pre></div>


<p>Or when using paging:</p>
<div class="highlight"><pre><span></span>$ pysource -m pathlib.PurePath -p
</pre></div>


<h2>PyPI</h2>
<p>I turned it into a package and <a href="https://pypi.org/project/pybites-pysource/1.0.0/">uploaded it to PyPI</a> (if you're curious how you can do this, check out <a href="https://pybit.es/opensource-package-pypi.html">this article</a>).</p>
<p>By the way, lesson learned: <a href="https://github.com/PyBites-Open-Source/pysource/commit/7a2b8dae046280530e3e558a52a141d52422e435">call your source folder something relevant</a> because that is how it ends up in your virtual environment's <code>site-packages</code> folder.</p>
<p>Try it out yourself! Just install it like <code>pip install pybites-pysource</code> (not to be confused with <code>pysource</code> which is another / unrelated package on PyPI, thanks Nils).</p>
<hr>
<p>This is still experimental but I hope it will already make it easier for you to read more Python (Standard Library) code.</p>
<p>Keep Calm and Code in Python!</p>
<p>-- Bob</p>


<div id="pbproducts">
  <h3>PyBites Python Tips</h3>
  <div>
    <p>Do you want to get <strong>250+ concise and applicable Python tips</strong> in an ebook that will cost you less than 10 bucks (future updates included), check it out <a href="https://gumroad.com/l/pbtips" target="_blank">here</a>.</p>
    <p>
      <a href="https://gumroad.com/l/pbtips" target="_blank">
        <img src="https://codechalleng.es/static/img/tips-book-thumb.07692e3ba331.png" alt="Get our Python Tips Book">
      </a>
    </p>

    <div id="testimonials">
      <p><i>"The discussions are succinct yet thorough enough to give you a solid grasp of the particular problem. I just wish I would have had this book when I started learning Python." - Daniel H </i></p>
      <p><i>"Bob and Julian are the masters at aggregating these small snippets of code that can really make certain aspects of coding easier." - Jesse B </i></p>
      <p><i>"This is now my favourite first Python go-to reference." - Anthony L </i></p>
      <p><i>"Do you ever go on one of those cooking websites for a recipe and have to scroll for what feels like an eternity to get to the ingredients and the 4 steps the recipe actually takes? This is the opposite of that." - Sergio S </i></p>
      <p class="buttonWrapper">
        <a class="button" href="https://gumroad.com/l/pbtips" target="_blank">
          Get the book
        </a>
      </p>
    </div>
  </div>
</div>    <div class="comments">
        <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'http-pybit-es';
                var disqus_identifier = 'get-python-source.html';
                var disqus_url = 'https://pybit.es/get-python-source.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
        <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>
        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="https://pybit.es/pages/guests.html">Authors</a></li>
                            <li><a href="https://pybit.es/pages/community.html">Community</a></li>
                            <li><a href="https://pybit.es/100days">#100DaysOfCode</a></li>
                            <li><a href="https://pybit.es/pages/search.html">Search</a></li>
                            <li><a href="https://pybit.es/pages/privacy-policy.html">Privacy Policy</a></li>
                              <li><a href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                              <li><a href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS Feed</a></li>
                            <li><a href="mailto:support@pybit.es" title="Contact us by email">Contact Us</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Reach Out</div>
                        <ul class="list-unstyled">
                            <li><a href="mailto:support@pybit.es" target="_blank">Email</a></li>
                            <li><a href="https://twitter.com/pybites" target="_blank">Twitter</a></li>
                            <li><a href="https://facebook.com/pybites" target="_blank">Facebook</a></li>
                            <li><a href="https://github.com/pybites" target="_blank">Github</a></li>
                            <li><a href="https://github.com/PyBites-Open-Source" target="_blank">Open Source</a></li>
                            <li><a href="https://www.youtube.com/channel/UCBn-uKDGsRBfcB0lQeOB_gA" target="_blank">YouTube</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; PyBites 2016+</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>