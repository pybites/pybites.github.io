<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="It&#39;s end of the week again so we review the code challenge of this week: Build a Tic-tac-toe Game. It&#39;s never late to join, just fork us and start coding. Our solution and learning You can find...">
        <meta name="keywords" content="AI, codechallenges, game, learning, tictactoe">
        <link rel="icon" href="https://pybit.es/favicon.ico">

        <title>Code Challenge 12 - Build a Tic-tac-toe Game - Review - PyBites</title>

        <!-- Stylesheets -->
        <link href="https://pybit.es/theme/css/all.min.css" rel="stylesheet">
        <link href="https://pybit.es/theme/css/style.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="PyBites Full Atom Feed" />
        <link href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Full RSS Feed" />
        <link href="https://pybit.es/feeds/challenges.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Categories RSS Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

          <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5859c6a67eb6254d" async="async"></script>

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-89294245-1', 'auto');
          ga('send', 'pageview');
        </script>
        <!-- /Google Analytics -->



    <!-- mailchimp subscribe -->
    <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">window.dojoRequire(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us14.list-manage.com","uuid":"822043293f280259d4b8d2a3e","lid":"ac7e2eb9ef","uniqueMethods":true}) })</script>
    <!-- end mailchimp subscribe -->

    <!-- Facebook Pixel Code -->
    <script>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '204929054292880');
      fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=204929054292880&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Facebook Pixel Code -->

    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="https://pybit.es/"><img class="mr20" src="https://pybit.es/images/logo.png" alt="logo"></a>
                    </div>
                    <div class="nav pull-right">

                        <div class="dropdown">
                          <span>RESOURCES</span>
                          <div class="dropdown-content">
                                <a href="/archives"
                                >Articles</a>
                                <a href="/pages/friends"
                                >Friends List</a>
                                <a href="/pages/community"
                                >Community</a>
                                <a href="/category/challenges"
                                >Blog Challenges</a>
                                <a href="https://github.com/PyBites-Open-Source"
                                    target="_blank"
                                >Open Source</a>
                                <a href="https://www.udemy.com/course/python-flask-for-beginners/"
                                    target="_blank"
                                >Flask Intro Course</a>
                          </div>
                        </div>

                        <div class="dropdown">
                          <span>SERVICES</span>
                          <div class="dropdown-content">
                                <a href="/pages/newbie"
                                >Newbies</a>
                                <a href="https://codechalleng.es"
                                    target="_blank"
                                >Python Exercises</a>
                                <a href="/pages/schools"
                                >Schools</a>
                                <a href="/pages/enterprise"
                                >Enterprise</a>
                                <a href="/pages/recruiting"
                                >Recruiter</a>
                                <a href="/pages/100days"
                                >100 Days Of Code</a>
                                <a href="/pages/apply"
                                >Coaching</a>
                          </div>
                        </div>

                        <div class="dropdown">
                          <a href="https://pybit.es/pages/talk" id="workshopButton">Talk With Us</a>
                        </div>

                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Code Challenge 12 - Build a Tic-tac-toe Game - Review</h1>
                      <p class="header-date"> <a href="https://pybit.es/author/pybites.html">PyBites</a>, Sat 01 April 2017,  <a href="https://pybit.es/category/challenges.html">Challenges</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="https://pybit.es/tag/ai.html">AI</a>, <a href="https://pybit.es/tag/codechallenges.html">codechallenges</a>, <a href="https://pybit.es/tag/game.html">game</a>, <a href="https://pybit.es/tag/learning.html">learning</a>, <a href="https://pybit.es/tag/tictactoe.html">tictactoe</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>It's end of the week again so we review the code challenge of this week: <a href="http://pybit.es/codechallenge12.html">Build a Tic-tac-toe Game</a>. It's never late to join, just <a href="https://github.com/pybites/challenges">fork us</a> and start coding.</p>
<h2>Our solution and learning</h2>
<p>You can find our solution <a href="https://github.com/pybites/challenges/blob/solutions/12/tictactoe.py">here</a>. This was great learning! Here are some highlights:</p>
<ul>
<li>
<p>We went for the AI opponent to play against. Not sure if it is unbeatable, but it has some 'intelligence' because it knows when to win, block you or take the next best moves (more on this later). We need to know a score for each position which we calculate by counting the number of times each position is in a winning combination:</p>
<div class="highlight"><pre><span></span><span class="n">WINNING_COMBINATIONS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">POSITION_VALUES</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span>
    <span class="n">itertools</span><span class="p">.</span><span class="k">chain</span><span class="p">(</span><span class="o">*</span><span class="n">WINNING_COMBINATIONS</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>


</li>
<li>
<p>Like Hangman, you have to keep state, so a class worked best for us and it is important to use a suitable data structure: a list of key numbers in the order of a typical key pad:</p>
<div class="highlight"><pre><span></span><span class="nv">VALID_POSITIONS</span> <span class="o">=</span> <span class="nv">list</span><span class="ss">(</span><span class="nv">range</span><span class="ss">(</span><span class="mi">1</span>, <span class="mi">10</span><span class="ss">))</span>
...

<span class="nv">class</span> <span class="nv">TicTacToe</span>:

    <span class="nv">def</span> <span class="nv">__init__</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:
        <span class="nv">self</span>.<span class="nv">board</span> <span class="o">=</span> [<span class="nv">None</span>] <span class="o">+</span> <span class="nv">len</span><span class="ss">(</span><span class="nv">VALID_POSITIONS</span><span class="ss">)</span> <span class="o">*</span> [<span class="nv">DEFAULT</span>]  # <span class="nv">skip</span> <span class="nv">index</span> <span class="mi">0</span>

<span class="s1">&#39;&#39;&#39;</span><span class="s">Simple tictactoe game, board positions are like keyboard</span>
                <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span>
                <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span>
                <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="s1">&#39;&#39;&#39;</span>

@<span class="nv">clear_screen</span>
<span class="nv">def</span> <span class="nv">__str__</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:
    <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
        {} <span class="o">|</span> {} <span class="o">|</span> {}
        {} <span class="o">|</span> {} <span class="o">|</span> {}
        {} <span class="o">|</span> {} <span class="o">|</span> {}
    <span class="s1">&#39;&#39;&#39;</span><span class="s">.format(*(self.board[7:] + self.board[4:7] + self.board[1:4]))</span>
</pre></div>


<p>The decorator is probably overkill but we use print(game) in two places so we did not want to duplicate code nor did we feel it was pure to clear the screen as part of __str__ (OK maybe we exaggerated, but the <a href="https://en.wikipedia.org/wiki/Decorator_pattern">decorator</a> is a useful feature you probably end up using!)</p>
</li>
<li>
<p>Probably the most important method is to determine if there is a win state. is_win() loops over all winning combinations and if there is not a DEFAULT (_) in the 3 positions and they are of the same ('O' or 'X') we have a win:</p>
<div class="highlight"><pre><span></span><span class="nv">def</span> <span class="nv">is_win</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:
    <span class="k">for</span> <span class="nv">combo</span> <span class="nv">in</span> <span class="nv">WINNING_COMBINATIONS</span>:
        <span class="nv">a</span>, <span class="nv">b</span>, <span class="nv">c</span> <span class="o">=</span> <span class="nv">combo</span>
        <span class="nv">combo_vals</span> <span class="o">=</span> <span class="nv">set</span><span class="ss">(</span>[<span class="nv">self</span>.<span class="nv">board</span>[<span class="nv">a</span>], <span class="nv">self</span>.<span class="nv">board</span>[<span class="nv">b</span>], <span class="nv">self</span>.<span class="nv">board</span>[<span class="nv">c</span>]]<span class="ss">)</span>
        <span class="k">if</span> <span class="nv">DEFAULT</span> <span class="nv">not</span> <span class="nv">in</span> <span class="nv">combo_vals</span> <span class="nv">and</span> <span class="nv">len</span><span class="ss">(</span><span class="nv">combo_vals</span><span class="ss">)</span> <span class="o">==</span> <span class="mi">1</span>:
            <span class="k">return</span> <span class="nv">True</span>
    <span class="k">return</span> <span class="nv">False</span>
</pre></div>


</li>
<li>
<p>Under main we drive the interface. It is one of the few times we choose a "for / else" construct, which some advice against. However here we liked it because there is a clear use case: if we break out of the for loop we have a win, else we ended performing all max 9 turns/moves, so we enter the for's else = game ends in 'draw'. The advantage of this approach is that we did not have to calculate the 'draw' scenario. We separated computer vs manual into 2 methods: ai_move() and manual_move():</p>
<div class="highlight"><pre><span></span><span class="k">while</span> <span class="nv">True</span>:
    <span class="nv">game</span> <span class="o">=</span> <span class="nv">TicTacToe</span><span class="ss">()</span>

    <span class="nv">turns</span> <span class="o">=</span> <span class="nv">itertools</span>.<span class="nv">cycle</span><span class="ss">(</span>[<span class="nv">first</span>, <span class="nv">second</span>]<span class="ss">)</span>
    <span class="nv">print</span><span class="ss">(</span><span class="nv">game</span><span class="ss">)</span>
    <span class="k">for</span> <span class="nv">_</span> <span class="nv">in</span> <span class="nv">VALID_POSITIONS</span>:
        <span class="nv">player</span> <span class="o">=</span> <span class="k">next</span><span class="ss">(</span><span class="nv">turns</span><span class="ss">)</span>
        <span class="k">if</span> <span class="nv">player</span> <span class="o">==</span> <span class="nv">COMPUTER</span>:
            <span class="nv">game</span>.<span class="nv">ai_move</span><span class="ss">()</span>
        <span class="k">else</span>:
            <span class="nv">game</span>.<span class="nv">manual_move</span><span class="ss">()</span>
        <span class="nv">print</span><span class="ss">(</span><span class="nv">game</span><span class="ss">)</span>
        <span class="k">if</span> <span class="nv">game</span>.<span class="nv">is_win</span><span class="ss">()</span>:
            <span class="nv">print</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">Player {} wins</span><span class="s1">&#39;</span>.<span class="nv">format</span><span class="ss">(</span><span class="nv">player</span><span class="ss">))</span>
            <span class="k">break</span>
    <span class="k">else</span>:  # <span class="k">for</span> <span class="o">/</span> <span class="k">else</span> <span class="nv">is</span> <span class="nv">frowned</span> <span class="nv">upon</span>, <span class="nv">I</span> <span class="k">do</span> <span class="nv">like</span> <span class="nv">it</span> <span class="nv">here</span> <span class="nv">though</span><span class="o">!</span>
        <span class="nv">print</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">Draw</span><span class="s1">&#39;</span><span class="ss">)</span>
</pre></div>


</li>
<li>
<p>The AI bit was the most interesting part. We went not as far as the full 8 steps in <a href="https://en.wikipedia.org/wiki/Tic-tac-toe#Strategy">tictactoe's strategy</a>, yet this will give you a bit of challenge. The computer checks first if it can win (end) the game, then if the player can win, if so prevent (block) that. If none of these two situations, it takes the best next move based on the before mentioned POSITION_VALUES which is a counter so its most_common() method returns most valuable positions first. Splitting this in multiple methods makes it easier maintainable.</p>
<div class="highlight"><pre><span></span><span class="nv">def</span> <span class="nv">ai_move</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:
    <span class="nv">self</span>.<span class="nv">_win_or_block</span><span class="ss">()</span> <span class="nv">or</span> <span class="nv">self</span>.<span class="nv">_take_best_next_free_pos</span><span class="ss">()</span>

<span class="nv">def</span> <span class="nv">_win_or_block</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:
    <span class="k">for</span> <span class="nv">combo</span> <span class="nv">in</span> <span class="nv">WINNING_COMBINATIONS</span>:
        <span class="nv">a</span>, <span class="nv">b</span>, <span class="nv">c</span> <span class="o">=</span> <span class="nv">combo</span>
        <span class="nv">combo_vals</span> <span class="o">=</span> [<span class="nv">self</span>.<span class="nv">board</span>[<span class="nv">a</span>], <span class="nv">self</span>.<span class="nv">board</span>[<span class="nv">b</span>], <span class="nv">self</span>.<span class="nv">board</span>[<span class="nv">c</span>]]
        # <span class="nv">can</span> <span class="nv">only</span> <span class="nv">use</span> <span class="nv">unitiated</span> <span class="nv">positions</span>
        <span class="k">if</span> <span class="nv">DEFAULT</span> <span class="nv">not</span> <span class="nv">in</span> <span class="nv">combo_vals</span>:
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nv">combo_vals</span>.<span class="nv">count</span><span class="ss">(</span><span class="nv">COMPUTER</span><span class="ss">)</span> <span class="o">==</span> <span class="mi">2</span>:
            <span class="k">return</span> <span class="nv">self</span>.<span class="nv">_update_board</span><span class="ss">(</span><span class="nv">combo</span>, <span class="nv">combo_vals</span><span class="ss">)</span>
        <span class="k">if</span> <span class="nv">combo_vals</span>.<span class="nv">count</span><span class="ss">(</span><span class="nv">PLAYER</span><span class="ss">)</span> <span class="o">==</span> <span class="mi">2</span>:
            <span class="k">return</span> <span class="nv">self</span>.<span class="nv">_update_board</span><span class="ss">(</span><span class="nv">combo</span>, <span class="nv">combo_vals</span><span class="ss">)</span>
    <span class="k">return</span> <span class="nv">False</span>

<span class="nv">def</span> <span class="nv">_take_best_next_free_pos</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:
    <span class="k">for</span> <span class="nv">pos</span>, <span class="nv">_</span> <span class="nv">in</span> <span class="nv">POSITION_VALUES</span>.<span class="nv">most_common</span><span class="ss">()</span>:
        <span class="k">if</span> <span class="nv">self</span>.<span class="nv">board</span>[<span class="nv">pos</span>] <span class="o">==</span> <span class="nv">DEFAULT</span>:
            <span class="nv">self</span>.<span class="nv">board</span>[<span class="nv">pos</span>] <span class="o">=</span> <span class="nv">COMPUTER</span>
            <span class="k">return</span> <span class="nv">True</span>
    <span class="k">return</span> <span class="nv">False</span>
</pre></div>


</li>
</ul>
<p>Again our full solution is <a href="https://github.com/pybites/challenges/blob/solutions/12/tictactoe.py">here</a>. Let us know if you have any questions or if you spot anything we could have done better.</p>
<h2>Community</h2>
<p>Here are some other ways to do it: from our <a href="https://github.com/pybites/challenges/blob/community/12/tictactoe-atakume.py">community branch</a> (remember you can submit code by PR!) and <a href="https://redd.it/61o56j">via reddit comment</a>). Reading other solutions to the same problem (as well as coding styles) is a great way to learn.</p>
<h2>Stay tuned</h2>
<p>Next week you will train your data analysis skills by parsing a movie data set. It will be fun :)</p>
<p>We hope you are enjoying these challenges, learning along the way. Let us know <a href="https://github.com/pybites/challenges/issues/new">if you have any issue</a> and/or <a href="mailto:pybitesblog@gmail.com">contact us</a> if you want to submit a cool challenge. See you next week ...</p>


    <div class="comments">
        <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'http-pybit-es';
                var disqus_identifier = 'codechallenge12_review.html';
                var disqus_url = 'https://pybit.es/codechallenge12_review.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
        <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>
        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="https://pybit.es/pages/guests.html">Authors</a></li>
                            <li><a href="https://pybit.es/pages/community.html">Community</a></li>
                            <li><a href="https://pybit.es/pages/100days.html">100 Days Of Code</a></li>
                            <li><a href="https://pybit.es/pages/search.html">Search</a></li>
                            <li><a href="https://pybit.es/pages/privacy-policy.html">Privacy Policy</a></li>
                              <li><a href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                              <li><a href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS Feed</a></li>
                            <li><a href="mailto:support@pybit.es" title="Contact us by email">Contact Us</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Reach Out</div>
                        <ul class="list-unstyled">
                            <li><a href="mailto:support@pybit.es" target="_blank">Email</a></li>
                            <li><a href="https://twitter.com/pybites" target="_blank">Twitter</a></li>
                            <li><a href="https://facebook.com/pybites" target="_blank">Facebook</a></li>
                            <li><a href="https://github.com/pybites" target="_blank">Github</a></li>
                            <li><a href="https://github.com/PyBites-Open-Source" target="_blank">Open Source</a></li>
                            <li><a href="https://www.youtube.com/channel/UCBn-uKDGsRBfcB0lQeOB_gA" target="_blank">YouTube</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; PyBites 2016+</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>